<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Cookbook</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <link rel="stylesheet" href="assets/style.css">
    <link rel="icon" href="assets/images/recipe.png"/>
</head>
<body>
    <div class="navbar">
        <ul class="nav">
            <li class="home">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="searchBtn">
              <a class="nav-link" href="search.html">Search</a>
            </li>
          </ul>
    </div>
    <div id="header">
        <h1 id="title">Search</h1>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <!--Search Bar here-->
        </div>
      </div>

      <div class="row">
        <div clas="col-lg-12">
          <div class="results">
            <div id="result0" class="result-card">
              <h3 class="recipe-title0">Recipe Title</h3>
              <p class="recipe-details0">Recipe description of recipe the description eventually to end with a... for viewing and linking</p>
              <p class="time0 details">Time: 40 minutes</p>
              <p class="difficulty0 details">Difficulty Rating: Beginner</p>
              <p class="rating0 details">5 Stars</p>

            </div>
          </div>
        </div>
      </div>

    </div>

    <div id="footer">
        <p>footer</p>
    </div>
    

    <script src="assets/script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
      retrieveRecipe();

      ingredientArray = [];

      function retrieveRecipe() {
        var apiKey = "6f8efb8f773b4ba3bc9fcb1c1d7d0e24";
        var ingredients = ingredientArray.join();
        var numberOfRecipes = $("#number-of-recipes").val();
        var recipeURL = "https://api.spoonacular.com/recipes/findByIngredients?apiKey=" + apiKey + "&ingredients=" + ingredients + "&number=" + numberOfRecipes;
        //var recipeURL = "https://api.spoonacular.com/recipes/findByIngredients?apiKey=6f8efb8f773b4ba3bc9fcb1c1d7d0e24&ingredients=apples,flour,sugar&number=2";

        $.ajax({
        url: recipeURL,
        method: "GET"
        }).then(function(response) {
          //$("#recipe-name").text(response.titel);
          console.log(response[0].title);
          console.log(response[0].id);
          console.log(response[0].image);
          console.log(response[0].missedIngredients.length);
          var ingredientsNeeded = response[0].missedIngredients.length;
          for (i = 0; i < ingredientsNeeded; i++) {
            console.log(response[0].missedIngredients[i].name);
          }

          var recipeID = response[0].id;
          var instructionsURL = "https://api.spoonacular.com/recipes/" + recipeID + "/analyzedInstructions?apiKey=" + apiKey;

          $.ajax({
            url: instructionsURL,
            method: "GET"
          }).then(function(response) {
            console.log(response[0].steps.length);
            var numberOfSteps = response[0].steps.length;
            for (var i = 0; i < numberOfSteps; i++) {
              console.log(response[0].steps[i].step);
              console.log(response[0].steps[i].ingredients.length);
              var numberOfIngredients = response[0].steps[i].ingredients.length;
              for (var j = 0; j < numberOfIngredients; j++) {
                console.log(response[0].steps[i].ingredients[j].name);
              }
            }
          });


        });
      }
    </script>
</body>
</html>